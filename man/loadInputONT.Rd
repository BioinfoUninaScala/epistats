% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/1_loadInputONT.R
\name{loadInputONT}
\alias{loadInputONT}
\title{Loading Input data.}
\usage{
loadInputONT(
  modkit_file,
  read_coord_bedfile,
  genome_assembly = "hg38",
  sel_chr = NULL,
  bases = "CG",
  mapq_th = 0,
  base_qual_th = 0,
  output_file = NULL,
  code_map = c(default = 1L, m = 2L, h = 3L),
  rm_zero_col = FALSE,
  nThread = 8
)
}
\arguments{
\item{modkit_file}{Path to the TSV file generated by `modkit extract calls`.
The file must contain the per-base modified base calls for each read, 
including reference position, strand, call code (e.g. m/h/u), call probability,
and other metadata exported by modkit.}

\item{read_coord_bedfile}{Path to a BED file containing genomic alignment coordinates for each read.
Typically generated with:
`samtools view -b -F 2308 <bam> | bedtools bamtobed`.  
The file must include at least 6 columns (chr, start, end, readID, score, strand).}

\item{genome_assembly}{A genome reference used to extract CpG positions and check reference bases.
Accepted values:  
- a **BSgenome object**,  
- the full package name of an installed BSgenome (e.g. `"BSgenome.Hsapiens.UCSC.hg38"`),  
- an **NCBI assembly name** (e.g. `"GRCh38"`),  
- a **UCSC assembly name** (e.g. `"hg38"`, `"mm10"`).  
If a character string is provided, the function attempts to load the 
corresponding BSgenome package automatically.}

\item{sel_chr}{Optional character vector specifying one or more chromosomes to include
(e.g. `"chr21"` or `c("chr21", "chr22")`).  
If `NULL`, all chromosomes present in both input files are processed.}

\item{bases}{Character vector specifying which dinucleotide(s) or motif(s) to analyze.
Default `"CG"` identifies CpG sites for 5mC/5hmC calling.  
Other motifs (e.g. `"CA"`, `"CT"`) can be used for alternative base modifications 
if present in the modkit output.}

\item{mapq_th}{Mapping quality threshold.
Only reads with mapping quality >= `mapq_th` (from the BED column 5 or BAM MAPQ)  
are included.  
Default `0` keeps all reads.}

\item{base_qual_th}{Minimum base calling quality threshold for including a modified base.
Corresponds to the `base_qual` column from `modkit extract calls`.  
Default `0` keeps all base calls.}

\item{output_file}{Optional path to save the generated list object (RDS format).
If `NULL`, the object is only returned in memory.}

\item{code_map}{Named numeric vector that maps `call_code` values
from the modkit output to integer codes used in the matrix.
Names must correspond to possible values of the `call_code` column
(e.g. "m", "h", "u", "c", "t", ...). A special name `"default"`
can be provided and is used for any `call_code` that is not
explicitly listed in `code_map`. For example:
`code_map = c(default = 1L, m = 2L, h = 3L)` will assign:
- 2 to `call_code == "m"`
- 3 to `call_code == "h"`
- 1 to all other codes.
Values are stored as signed integers; if `ref_strand == "-"`,
the value is multiplied by -1.}

\item{rm_zero_col}{Boolean value. When set to TRUE, zero columns are filtered out. Default value: FALSE.}

\item{nThread}{Number of threads used by data.table::fread() to load modkit_file and read_coord_bedfile.}
}
\value{
A sparse matrix (Matrix::dgCMatrix) with reads in rows and genomic motif positions in columns.
}
\description{
Loading Input data.
}
