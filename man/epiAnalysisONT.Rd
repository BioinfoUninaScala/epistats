% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/6_epiAnalysisONT.R
\name{epiAnalysisONT}
\alias{epiAnalysisONT}
\title{Extracting epiallele information from customised target regions.}
\usage{
epiAnalysisONT(
  sparseMat,
  bins,
  code_map_epiallele = c(`1` = 0, `2` = 1, `3` = 0),
  stranded = FALSE,
  threshold,
  myfuns,
  sample_name,
  pathDir,
  cores = 1
)
}
\arguments{
\item{sparseMat}{A sparse matrix (dgCMatrix) generated by `loadInputONT()`, where rows are reads 
and columns are genomic motif positions (e.g. CpGs) encoded as `"chr_pos"`.}

\item{bins}{A `GRanges` object defining the target genomic intervals. Typically generated 
using `makeWindows()` or `makeBins()`.}

\item{code_map_epiallele}{Named integer vector defining how the sparse matrix values (e.g. 1, 2, 3) 
should be converted into binary epialleles (e.g. unmethylated = 0, methylated = 1).}

\item{stranded}{Logical indicating whether the analysis should be performed in strand-specific 
mode (`TRUE`) or by merging both strands (`FALSE`). Default: `FALSE`.}

\item{threshold}{Minimum number of reads required for a region to be analysed. Regions with 
total coverage below this threshold are discarded and reported in the log.}

\item{myfuns}{A named list of functions to compute summary statistics on the binary 
epiallele matrix (e.g. mean methylation, Shannon entropy, number of epialleles).}

\item{sample_name}{Character string indicating the sample name used for labelling outputs.}

\item{pathDir}{Directory in which results will be saved. If `NULL`, results are returned but 
not written to disk.}

\item{cores}{Integer specifying the number of CPU cores used for parallel processing.}
}
\value{
A list with the following components:
\itemize{
  \item **intervals** — Data frame where each row corresponds to a processed 
  genomic region, containing summary statistics produced by `myfuns`.

  \item **epi** — Data frame containing compressed epiallele composition for 
  each region (e.g. epiallele sequences and their frequencies).

  \item **log** — Data frame listing genomic intervals that did not satisfy 
  minimum coverage requirements or were otherwise excluded.
}
}
\description{
This function takes a user-defined set of genomic regions (in the form of a 
GRanges object) and extracts, for each interval, the epiallele composition and 
summary statistics such as average methylation, Shannon entropy, epiallele 
diversity, etc.

The function works on the sparse matrix generated by `loadInputONT()`, where 
rows correspond to reads and columns correspond to genomic positions. For each 
region, the corresponding submatrix is extracted, optionally separated by 
strand, converted to binary epialleles, and summarised.
}
